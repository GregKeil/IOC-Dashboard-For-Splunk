<form version="1.1" theme="dark">
  <label>IOC Dashboard (V5.4)</label>
  <description>V5 Additions: Dashboard Now Runs Actively Through The Use Of Data Models, Allows For Time Selection, Permits Summarization Usage &amp; Allows For Time Of Occurence To Be Displayed</description>
  <fieldset submitButton="false" autoRun="true">
    <html>
       <style>
         .btn {
        font-family: monospace;
        color: #000000;
        background-color: #65A637  !important;
           }
         div.fieldset.dashboard-form-globalfieldset div.dashboard-element.html.dashboard-element-html {
        display: inline-block;
           }
       </style>
     </html>
    <input type="time" token="TimeSelection" searchWhenChanged="true">
      <label>Time Selection</label>
      <default>
        <earliest>-24h@h</earliest>
        <latest>now</latest>
      </default>
    </input>
    <input type="radio" token="ShowTime">
      <label>Show Times</label>
      <choice value="">Disabled</choice>
      <choice value=",_time">Enabled</choice>
      <default></default>
    </input>
    <input type="radio" token="SumSearch">
      <label>Summarized Search</label>
      <choice value="f">Disabled</choice>
      <choice value="t">Enabled</choice>
      <default>f</default>
    </input>
  </fieldset>
  <row>
    <panel>
      <single>
        <title>Unique Source IP Hits</title>
        <search>
          <query>| tstats summariesonly=$SumSearch$ count from datamodel=Zeek.IP by IP.id_orig_h
| rename IP.id_orig_h as src
| fields src
| where isnotnull(src)
| lookup local=t IP_iocs.csv indicator AS src OUTPUT kill_chains, published_date, malware_families, actors, ioc_type
| where isnotnull(ioc_type)
| stats count</query>
          <earliest>$TimeSelection.earliest$</earliest>
          <latest>$TimeSelection.latest$</latest>
        </search>
        <option name="drilldown">none</option>
        <option name="rangeColors">["0x53a051","0xf8be34","0xf1813f","0xdc4e41"]</option>
        <option name="rangeValues">[0,5,10]</option>
        <option name="refresh.display">progressbar</option>
        <option name="useColors">1</option>
      </single>
    </panel>
    <panel>
      <single>
        <title>Total Source IP Hits</title>
        <search>
          <query>| tstats summariesonly=$SumSearch$ count from datamodel=Zeek.IP by IP.id_orig_h,_time
| rename IP.id_orig_h as src
| fields src
| where isnotnull(src)
| lookup local=t IP_iocs.csv indicator AS src OUTPUT kill_chains, published_date, malware_families, actors, ioc_type
| where isnotnull(ioc_type)
| stats count</query>
          <earliest>$TimeSelection.earliest$</earliest>
          <latest>$TimeSelection.latest$</latest>
        </search>
        <option name="drilldown">none</option>
        <option name="rangeColors">["0x53a051","0xf8be34","0xf1813f","0xdc4e41"]</option>
        <option name="rangeValues">[0,5,15]</option>
        <option name="refresh.display">progressbar</option>
        <option name="useColors">1</option>
      </single>
    </panel>
    <panel>
      <single>
        <title>Unique Destination IP Hits</title>
        <search>
          <query>| tstats summariesonly=$SumSearch$ count from datamodel=Zeek.IP by IP.id_resp_h
| rename IP.id_resp_h as dest
| fields dest
| where isnotnull(dest)
| lookup local=t IP_iocs.csv indicator AS dest OUTPUT kill_chains, published_date, malware_families, actors, ioc_type
| where isnotnull(ioc_type)
| stats count</query>
          <earliest>$TimeSelection.earliest$</earliest>
          <latest>$TimeSelection.latest$</latest>
        </search>
        <option name="drilldown">none</option>
        <option name="rangeColors">["0x53a051","0xf8be34","0xf1813f","0xdc4e41"]</option>
        <option name="rangeValues">[0,5,10]</option>
        <option name="refresh.display">progressbar</option>
        <option name="useColors">1</option>
      </single>
    </panel>
    <panel>
      <single>
        <title>Total Destination IP Hits</title>
        <search>
          <query>| tstats summariesonly=$SumSearch$ count from datamodel=Zeek.IP by IP.id_resp_h,_time
| rename IP.id_resp_h as dest
| fields dest
| where isnotnull(dest)
| lookup local=t IP_iocs.csv indicator AS dest OUTPUT kill_chains, published_date, malware_families, actors, ioc_type
| where isnotnull(ioc_type)
| stats count</query>
          <earliest>$TimeSelection.earliest$</earliest>
          <latest>$TimeSelection.latest$</latest>
        </search>
        <option name="drilldown">none</option>
        <option name="rangeColors">["0x53a051","0xf8be34","0xf1813f","0xdc4e41"]</option>
        <option name="rangeValues">[0,5,15]</option>
        <option name="refresh.display">progressbar</option>
        <option name="useColors">1</option>
      </single>
    </panel>
  </row>
  <row>
    <panel>
      <single>
        <title>Unique Domain Hits</title>
        <search>
          <query>| tstats summariesonly=$SumSearch$ count from datamodel=Zeek.DNS by DNS.query
| rename DNS.query as query
| fields query
| where isnotnull(query)
| lookup local=t Domain_iocs.csv indicator AS query OUTPUT kill_chains, published_date, malware_families, actors, ioc_type
| where isnotnull(ioc_type)
| stats count</query>
          <earliest>$TimeSelection.earliest$</earliest>
          <latest>$TimeSelection.latest$</latest>
        </search>
        <option name="drilldown">none</option>
        <option name="rangeColors">["0x53a051","0xf8be34","0xf1813f","0xdc4e41"]</option>
        <option name="rangeValues">[0,5,10]</option>
        <option name="refresh.display">progressbar</option>
        <option name="useColors">1</option>
      </single>
    </panel>
    <panel>
      <single>
        <title>Total Domain Hits</title>
        <search>
          <query>| tstats summariesonly=$SumSearch$ count from datamodel=Zeek.DNS by DNS.query,_time
| rename DNS.query as query
| fields query
| where isnotnull(query)
| lookup local=t Domain_iocs.csv indicator AS query OUTPUT kill_chains, published_date, malware_families, actors, ioc_type
| where isnotnull(ioc_type)
| stats count</query>
          <earliest>$TimeSelection.earliest$</earliest>
          <latest>$TimeSelection.latest$</latest>
        </search>
        <option name="drilldown">none</option>
        <option name="rangeColors">["0x53a051","0xf8be34","0xf1813f","0xdc4e41"]</option>
        <option name="rangeValues">[0,5,15]</option>
        <option name="refresh.display">progressbar</option>
        <option name="useColors">1</option>
      </single>
    </panel>
    <panel>
      <single>
        <title>Unique URL Hits</title>
        <search>
          <query>| tstats summariesonly=$SumSearch$ count from datamodel=Zeek.DNS by DNS.answer
| rename DNS.answer as answer
| fields answer
| where isnotnull(answer)
| lookup local=t URL_iocs.csv indicator AS answer OUTPUT kill_chains, published_date, malware_families, actors, ioc_type
| where isnotnull(ioc_type)
| stats count</query>
          <earliest>$TimeSelection.earliest$</earliest>
          <latest>$TimeSelection.latest$</latest>
        </search>
        <option name="colorMode">none</option>
        <option name="drilldown">none</option>
        <option name="rangeColors">["0x53a051","0xf8be34","0xf1813f","0xdc4e41"]</option>
        <option name="rangeValues">[0,5,10]</option>
        <option name="refresh.display">progressbar</option>
        <option name="unitPosition">before</option>
        <option name="useColors">1</option>
      </single>
    </panel>
    <panel>
      <single>
        <title>Total URL Hits</title>
        <search>
          <query>| tstats summariesonly=$SumSearch$ count from datamodel=Zeek.DNS by DNS.answer,_time
| rename DNS.answer as answer
| fields answer
| where isnotnull(answer)
| lookup local=t URL_iocs.csv indicator AS answer OUTPUT kill_chains, published_date, malware_families, actors, ioc_type
| where isnotnull(ioc_type)
| stats count</query>
          <earliest>$TimeSelection.earliest$</earliest>
          <latest>$TimeSelection.latest$</latest>
        </search>
        <option name="drilldown">none</option>
        <option name="rangeColors">["0x53a051","0xf8be34","0xf1813f","0xdc4e41"]</option>
        <option name="rangeValues">[0,5,15]</option>
        <option name="refresh.display">progressbar</option>
        <option name="useColors">1</option>
      </single>
    </panel>
  </row>
  <row>
    <panel>
      <single>
        <title>Unique MD5 Hits</title>
        <search>
          <query>| tstats summariesonly=$SumSearch$ count from datamodel=Hashes.Sysmon by Sysmon.MD5
| rename Sysmon.MD5 as MD5
| fields MD5
| where isnotnull(MD5)
| lookup local=t MD5_iocs.csv indicator AS MD5 OUTPUT kill_chains, published_date, malware_families, actors, ioc_type
| where isnotnull(ioc_type)
| stats count</query>
          <earliest>$TimeSelection.earliest$</earliest>
          <latest>$TimeSelection.latest$</latest>
        </search>
        <option name="drilldown">none</option>
        <option name="rangeColors">["0x53a051","0xf8be34","0xf1813f","0xdc4e41"]</option>
        <option name="rangeValues">[0,5,10]</option>
        <option name="refresh.display">progressbar</option>
        <option name="useColors">1</option>
      </single>
    </panel>
    <panel>
      <single>
        <title>Total MD5 Hits</title>
        <search>
          <query>| tstats summariesonly=$SumSearch$ count from datamodel=Hashes.Sysmon by Sysmon.MD5,_time
| rename Sysmon.MD5 as MD5
| fields MD5
| where isnotnull(MD5)
| lookup local=t MD5_iocs.csv indicator AS MD5 OUTPUT kill_chains, published_date, malware_families, actors, ioc_type
| where isnotnull(ioc_type)
| stats count</query>
          <earliest>$TimeSelection.earliest$</earliest>
          <latest>$TimeSelection.latest$</latest>
        </search>
        <option name="drilldown">none</option>
        <option name="rangeColors">["0x53a051","0xf8be34","0xf1813f","0xdc4e41"]</option>
        <option name="rangeValues">[0,5,15]</option>
        <option name="refresh.display">progressbar</option>
        <option name="useColors">1</option>
      </single>
    </panel>
    <panel>
      <single>
        <title>Unique SHA256 Hits</title>
        <search>
          <query>| tstats summariesonly=$SumSearch$ count from datamodel=Hashes.Sysmon by Sysmon.SHA256
| rename Sysmon.SHA256 as SHA256
| fields SHA256
| where isnotnull(SHA256)
| lookup local=t SHA256_iocs.csv indicator AS SHA256 OUTPUT kill_chains, published_date, malware_families, actors, ioc_type
| where isnotnull(ioc_type)
| stats count</query>
          <earliest>$TimeSelection.earliest$</earliest>
          <latest>$TimeSelection.latest$</latest>
        </search>
        <option name="drilldown">none</option>
        <option name="rangeColors">["0x53a051","0xf8be34","0xf1813f","0xdc4e41"]</option>
        <option name="rangeValues">[0,5,10]</option>
        <option name="refresh.display">progressbar</option>
        <option name="useColors">1</option>
      </single>
    </panel>
    <panel>
      <single>
        <title>Total SHA256 Hits</title>
        <search>
          <query>| tstats summariesonly=$SumSearch$ count from datamodel=Hashes.Sysmon by Sysmon.SHA256,_time
| rename Sysmon.SHA256 as SHA256
| fields SHA256
| where isnotnull(SHA256)
| lookup local=t SHA256_iocs.csv indicator AS SHA256 OUTPUT kill_chains, published_date, malware_families, actors, ioc_type
| where isnotnull(ioc_type)
| stats count</query>
          <earliest>$TimeSelection.earliest$</earliest>
          <latest>$TimeSelection.latest$</latest>
        </search>
        <option name="drilldown">none</option>
        <option name="rangeColors">["0x53a051","0xf8be34","0xf1813f","0xdc4e41"]</option>
        <option name="rangeValues">[0,5,15]</option>
        <option name="refresh.display">progressbar</option>
        <option name="useColors">1</option>
      </single>
    </panel>
  </row>
  <row>
    <panel>
      <table>
        <title>Full Source IP Hit Listing</title>
        <search>
          <query>| tstats summariesonly=$SumSearch$ count from datamodel=Zeek.IP by IP.id_orig_h,_time
| rename IP.id_orig_h as src
| fields src,_time
| where isnotnull(src)
| lookup local=t IP_iocs.csv indicator AS src OUTPUT kill_chains, published_date, malware_families, actors, ioc_type
| where isnotnull(ioc_type)
| fillnull value="N/A" actors,kill_chains,last_updated,malicious_confidence,malware_families,published_date
| stats count by src, kill_chains, actors, malware_families, published_date $ShowTime$
| rename src AS "Instance",kill_chains AS "Kill Chain",malware_families AS "Malware Family",actors AS "Actor",published_date AS "Publish Date", count AS "Count"
| appendpipe [| stats count | where count=0 | eval Instance="No Instances Found" | fields Instance]</query>
          <earliest>$TimeSelection.earliest$</earliest>
          <latest>$TimeSelection.latest$</latest>
        </search>
        <option name="drilldown">none</option>
        <option name="refresh.display">progressbar</option>
        <option name="rowNumbers">false</option>
        <option name="totalsRow">false</option>
      </table>
    </panel>
    <panel>
      <table>
        <title>Full Destination IP Hit Listing</title>
        <search>
          <query>| tstats summariesonly=$SumSearch$ count from datamodel=Zeek.IP by IP.id_resp_h,_time
| rename IP.id_resp_h as dest
| fields dest,_time
| where isnotnull(dest)
| lookup local=t IP_iocs.csv indicator AS dest OUTPUT kill_chains, published_date, malware_families, actors, ioc_type
| where isnotnull(ioc_type)
| fillnull value="N/A" actors,kill_chains,last_updated,malicious_confidence,malware_families,published_date
|stats count by dest, kill_chains, actors, malware_families, published_date $ShowTime$
| rename dest AS "Instance",kill_chains AS "Kill Chain",malware_families AS "Malware Family",actors AS "Actor",published_date AS "Publish Date", count AS "Count"
| appendpipe [| stats count | where count=0 | eval Instance="No Instances Found" | fields Instance]</query>
          <earliest>$TimeSelection.earliest$</earliest>
          <latest>$TimeSelection.latest$</latest>
        </search>
        <option name="dataOverlayMode">none</option>
        <option name="drilldown">none</option>
        <option name="percentagesRow">false</option>
        <option name="refresh.display">progressbar</option>
        <option name="rowNumbers">false</option>
        <option name="totalsRow">false</option>
        <option name="wrap">true</option>
      </table>
    </panel>
  </row>
  <row>
    <panel>
      <table>
        <title>Full Domain Hit Listing</title>
        <search>
          <query>| tstats summariesonly=$SumSearch$ count from datamodel=Zeek.DNS by DNS.query,_time
| rename DNS.query as query
| fields query,_time
| where isnotnull(query)
| lookup local=t Domain_iocs.csv indicator AS query OUTPUT kill_chains, published_date, malware_families, actors, ioc_type
| where isnotnull(ioc_type)
| fillnull value="N/A" actors,kill_chains,last_updated,malicious_confidence,malware_families,published_date
|stats count by query, kill_chains, actors, malware_families, published_date $ShowTime$
| rename query AS "Instance",kill_chains AS "Kill Chain",malware_families AS "Malware Family",actors AS "Actor",published_date AS "Publish Date", count AS "Count"
| appendpipe [| stats count | where count=0 | eval Instance="No Instances Found" | fields Instance]</query>
          <earliest>$TimeSelection.earliest$</earliest>
          <latest>$TimeSelection.latest$</latest>
        </search>
        <option name="drilldown">none</option>
        <option name="refresh.display">progressbar</option>
        <option name="rowNumbers">false</option>
      </table>
    </panel>
    <panel>
      <table>
        <title>Full URL Hit Listing</title>
        <search>
          <query>| tstats summariesonly=$SumSearch$ count from datamodel=Zeek.DNS by DNS.answer,_time
| rename DNS.answer as answer
| fields answer,_time
| where isnotnull(answer)
| lookup local=t URL_iocs.csv indicator AS answer OUTPUT kill_chains, published_date, malware_families, actors, ioc_type
| where isnotnull(ioc_type)
| fillnull value="N/A" actors,kill_chains,last_updated,malicious_confidence,malware_families,published_date
|stats count by answer, kill_chains, actors, malware_families, published_date $ShowTime$
| rename answer AS "Instance",kill_chains AS "Kill Chain",malware_families AS "Malware Family",actors AS "Actor",published_date AS "Publish Date", count AS "Count"
| appendpipe [| stats count | where count=0 | eval Instance="No Instances Found" | fields Instance]</query>
          <earliest>$TimeSelection.earliest$</earliest>
          <latest>$TimeSelection.latest$</latest>
        </search>
        <option name="drilldown">none</option>
        <option name="refresh.display">progressbar</option>
        <option name="rowNumbers">false</option>
      </table>
    </panel>
  </row>
  <row>
    <panel>
      <table>
        <title>Full MD5 Hit Listing</title>
        <search>
          <query>| tstats summariesonly=$SumSearch$ count from datamodel=Hashes.Sysmon by Sysmon.MD5,_time
| rename Sysmon.MD5 as MD5
| fields MD5,_time
| where isnotnull(MD5)
| lookup local=t MD5_iocs.csv indicator AS MD5 OUTPUT kill_chains, published_date, malware_families, actors, ioc_type
| where isnotnull(ioc_type)
| fillnull value="N/A" actors,kill_chains,last_updated,malicious_confidence,malware_families,published_date
|stats count by MD5, kill_chains, actors, malware_families, published_date $ShowTime$
| rename MD5 AS "Instance",kill_chains AS "Kill Chain",malware_families AS "Malware Family",actors AS "Actor",published_date AS "Publish Date", count AS "Count"
| appendpipe [| stats count | where count=0 | eval Instance="No Instances Found" | fields Instance]</query>
          <earliest>$TimeSelection.earliest$</earliest>
          <latest>$TimeSelection.latest$</latest>
        </search>
        <option name="drilldown">none</option>
        <option name="refresh.display">progressbar</option>
        <option name="rowNumbers">false</option>
      </table>
    </panel>
    <panel>
      <table>
        <title>Full SHA256 Hit Listing</title>
        <search>
          <query>| tstats summariesonly=$SumSearch$ count from datamodel=Hashes.Sysmon by Sysmon.SHA256,_time
| rename Sysmon.SHA256 as SHA256
| fields SHA256,_time
| where isnotnull(SHA256)
| lookup local=t SHA256_iocs.csv indicator AS SHA256 OUTPUT kill_chains, published_date, malware_families, actors, ioc_type
| where isnotnull(ioc_type)
| fillnull value="N/A" actors,kill_chains,last_updated,malicious_confidence,malware_families,published_date
|stats count by SHA256, kill_chains, actors, malware_families, published_date $ShowTime$
| rename SHA256 AS "Instance",kill_chains AS "Kill Chain",malware_families AS "Malware Family",actors AS "Actor",published_date AS "Publish Date", count AS "Count"
| appendpipe [| stats count | where count=0 | eval Instance="No Instances Found" | fields Instance]</query>
          <earliest>$TimeSelection.earliest$</earliest>
          <latest>$TimeSelection.latest$</latest>
        </search>
        <option name="dataOverlayMode">none</option>
        <option name="drilldown">none</option>
        <option name="refresh.display">progressbar</option>
        <option name="rowNumbers">false</option>
      </table>
    </panel>
  </row>
</form>